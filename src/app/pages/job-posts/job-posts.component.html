<!-- 
<mat-tab-group>
    <mat-tab label="First"> Content 1 </mat-tab>
    <mat-tab label="Second"> Content 2 </mat-tab>
    <mat-tab label="Third"> Content 3 </mat-tab>
  </mat-tab-group> -->
<!-- <div class="border-bottom tolbar mb-5 px-4">
    <a href="#" class="btn btn-active-light-primary ">Primary</a>
    <a href="#" class="btn btn-active-light-primary ">Primary</a>
  </div> -->
<div *ngIf="isLoading" class="pause d-flex align-items-center justify-content-center">
    <div class="spinner"></div>
</div>
<div class="border-bottom tolbar mb-5 px-4   d-flex align-items-stretch justify-content-between">
    <ul class="nav nav-line-tabs nav-line-tabs-1x nav-stretch ">
        <li class="nav-item">
            <a data-bs-toggle="tab" class="nav-link px-4 fw-semibold" (click)="getSelectedTab('NewJob')"
                [ngClass]="{'active': selectedTab=='NewJob', 'cursor-pointer': selectedTab !=='NewJob'}"> New Jobs <span class="badge badge-light-primary ms-3">
                    <i class="bi bi-arrow-down-left px-1 text-primary fs-9 me-2"></i> {{jobCount?.activeJobPost}}</span> </a>
        </li>

        <li class="nav-item">
            <a data-bs-toggle="tab" class="nav-link px-4 fw-semibold" (click)="getSelectedTab('AppliedJob')"
                [ngClass]="{'active': selectedTab=='AppliedJob', 'cursor-pointer': selectedTab !=='AppliedJob'}"> Applied Jobs <span
                    class="badge badge-light-warning ms-3"><i
                        class="bi bi-arrow-up-right px-1 text-warning fs-9 me-2"></i> {{jobCount?.appliedjobcount}}</span></a>
        </li>
        <li class="nav-item">
            <a data-bs-toggle="tab" class="nav-link px-4 fw-semibold" (click)="getSelectedTab('ConfirmedJob')"
                [ngClass]="{'active': selectedTab=='ConfirmedJob', 'cursor-pointer': selectedTab !=='ConfirmedJob'}"> Confirmed Jobs
                <span
                    class="badge badge-light-success ms-3"><i class="bi bi-check2-circle fs-7 me-2"></i> {{jobCount?.confirmedjobcount}}</span></a>
        </li>
    </ul>
    <!-- <a href="" class="btn btn-primary btn-sm cursor-pointer my-2" routerLink="creat-job-post" > Create Job Post</a> -->
    </div>
    <div class="row g-xl-12 mb-5 mb-xl-12">
        <div class="w-250px text-gray-600 h-100">
            <div class="card p-4">
                <div class="position-relative input-icon  ">
                    <input type="text" class="form-control py-2 fs- fw-normal px-11" [(ngModel)]="filter.searchText"  placeholder="Search for a Job"  (keyup)="searchFilter($event)"/>
                    <span><i class="fa fa-search "></i></span>
                    <span class="cursor-pointer text-active-primary pspinpClose" 
                    (click) = "filter.searchText = '';clearSearch();" *ngIf="filter.searchText && filter.searchText != ''">
                    <i class="bi bi-x-lg text-active-primary"></i></span>
                </div>

                <div class="py-4">
                    Filter by <a class="px-4 fs-8 cursor-pointer" (click)="resetFilter();">Reset Filters</a>
                </div>
                <div class="separator mb-5"></div>

                <div class="fs-8 text-muted mb-5">Job Type </div>
                <label class="checkbox checkbox-outline checkbox-outline-2x checkbox-primary">
                    <input type="checkbox" [checked]="selected" value="All" (change)="filterJobType($event, -1)"/>
                    <span></span>
                    All
                </label>
                <label class="checkbox checkbox-outline checkbox-outline-2x checkbox-primary"
                    *ngFor="let types of jobTypes;let index = index;">
                    <input type="checkbox" [checked]="selectedJobTypes[index]" [value]="types.id" (change)="filterJobType($event, index)"/>
                    <span></span>
                    {{types.name}}
                </label>

                <ng-container *ngIf="selectedTab=='AppliedJob'">
                    <div class="fs-8 text-muted mb-2 mt-5">JOB Status </div>
                    <label class="checkbox checkbox-outline checkbox-outline-2x checkbox-primary">
                            <input type="checkbox" value="All" [checked]="selectedJobStatusAll" (change)="filterJobStatus($event, -1)"/>
                        <span></span> All Types
                    </label>
                    <label class="checkbox checkbox-outline checkbox-outline-2x checkbox-primary">
                            <input type="checkbox" value="OfferSent" [checked]="selectedJobStatus[0]" (change)="filterJobStatus($event, 0)"/>
                        <span></span> Offer Sent
                    </label>
                    <label class="checkbox checkbox-outline checkbox-outline-2x checkbox-primary">
                        <input type="checkbox" value="OnHold" [checked]="selectedJobStatus[1]" (change)="filterJobStatus($event, 1)"/>
                        <span></span>  On Hold
                    </label>
                    <label class="checkbox checkbox-outline checkbox-outline-2x checkbox-primary">
                        <input type="checkbox" value="Rejected" [checked]="selectedJobStatus[2]" (change)="filterJobStatus($event, 2)"/>
                        <span></span>  Rejected
                    </label>
                    </ng-container>
           
                    <div class="separator separator-dashed my-5"></div>
            <div class="fs-8 text-muted mb-2">PAY RATE </div>
                <label class="checkbox checkbox-outline checkbox-outline-2x checkbox-primary">
                    <input type="checkbox" value="All" [checked]="selectedJobKindAll" (change)="filterJobKind($event, -1)"/>
                    <span></span> All 
                </label>
                <label class="checkbox checkbox-outline checkbox-outline-2x checkbox-primary">
                    <input type="checkbox" value="Hourly" [checked]="selectedJobKind[0]" (change)="filterJobKind($event, 0)"/>
                    <span></span> Hour Based
                </label>
                <label class="checkbox checkbox-outline checkbox-outline-2x checkbox-primary">
                    <input type="checkbox" value="Fixed" [checked]="selectedJobKind[1]" (change)="filterJobKind($event, 1)"/>
                    <span></span> Fixed
                </label>
                           
                <div class="separator separator-dashed my-5"></div>

          
            <div class="fs-8 text-muted mb-3">Work Area</div>
            <div class="mb-5">
                <mat-select class="form-select fs- py-2"  placeholder="Select Site" [(value)] = "filter.site" (selectionChange)="filterSite($event)">
                    <mat-option *ngFor="let sites of sitesList" [value]="sites.code">
                        {{sites.name}} ({{sites.code}})
                    </mat-option>
                </mat-select>
            </div>
            <div class="mb-5">
                <mat-select class="form-select fs- py-2"  placeholder="Select Business Unit" [(value)] = "filter.businessUnit" (selectionChange)="filterBusinessUnit($event)">
                    <mat-option *ngFor="let units of businessUnits" [value]="units.code">
                        {{units.name}}
                    </mat-option>
                </mat-select>
            </div>
            <div class="separator separator-dashed mb-5"></div>
        </div>
    </div>

    <div class="col ">
        <ng-container *ngIf="selectedTab=='NewJob'">
            <ng-container *ngFor="let details of jobDetails | slice: currentPage * pageSize : (currentPage + 1) * pageSize">
                <div class="card mb-2 ">
                    <div class="card-body py-5">

                        <div class="d-flex justify-content-between align-items-start flex-wrap">
                            <div class="d-flex flex-column w-75">

                                <h6 class="text-dark  text-gray-800 fs-3  me-1">
                                    {{details.title}}
                                </h6>
                                <div class="d-flex">
                                    <a class="fw-bold display-inline cursor-pointer" (click)="goToDetails(details.id)"> #{{details.id}}</a>
                                </div>
                                <span class="fs-7 text-muted mt-1 mb-5">created on {{details.registerDate | date:'dd MMM, yyyy'}}</span>


                                <div class="d-flex flex-wrap flex-stack">
                                    <div class="d-flex flex-column flex-grow-1 pe-8">
                                        <div class="d-flex flex-wrap lign-items-center">
                                            <div class=" me-10 my-1">
                                                <span class="d-flex text-muted fs-8">{{details.jobKind == 'Fixed' ? 'Budget' : 'Working Rate'}}</span>
                                                <span class="fw-bold d-flex">{{details.jobKind == 'Fixed' ? details.minBudget + ' ~ ' + details.maxBudget : details.rate}} {{details.currency}}</span>
                                            </div>
                                          
                                            <div class="vr me-5 mt-4 h-20px "></div>
                                            <div class=" me-10 my-1">
                                                <span class="d-flex text-muted fs-8">Business Unit</span>
                                                <span class="fw-bold d-flex ">{{details.businessUnit}}</span>
                                            </div>
                                            <div class="vr me-5 mt-4 h-20px "></div>
                                            <div class=" me-10 my-1">
                                                <span class="d-flex text-muted fs-8">Site</span>
                                                <span class="fw-bold d-flex">{{details.site}}</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div>
                                <div> <div class="w-20px display-inline my-1 me-1"><img class="" src="../../../assets/images/icons/calendar.svg" alt=""> </div> {{details.startDate | date:'MMM dd'}} - {{details.endDate | date:'dd MMM, yyyy'}} </div>
                                <div><div class="w-20px  display-inline my-1 me-1"><img class="" src="../../../assets/images/icons/coin.svg" alt=""></div> {{details.jobKind}}</div>
                                <div><div class="w-20px  display-inline my-1 me-1"><img class="" src="../../../assets/images/icons/case.svg" alt=""></div> {{details.type}}</div>
                                <a class="btn btn-primary btn-sm cursor-pointer mt-3" (click)="goToDetails(details.id)"> Apply Now</a>
                            </div>
                        </div>
                    </div>
                </div>

            </ng-container>
        </ng-container>

        <ng-container *ngIf="selectedTab=='AppliedJob'">
            <ng-container *ngFor="let details of jobDetails | slice: currentPage * pageSize : (currentPage + 1) * pageSize">
                <div class="card mb-2 cursor-pointer" (click)="goToDetails(details.id)">
                    <div class="card-body py-5">

                        <div class="d-flex justify-content-between align-items-start flex-wrap">
                            <div class="d-flex flex-column w-75">

                                <h6 class="text-dark  text-gray-800 fs-3  me-1">
                                    {{details.title}}
                                </h6>
                                <div class="d-flex">
                                    <a class="cursor-pointer fw-bold display-inline"> #{{details.id}}</a>
                                    <span class="badge badge-light-success fw-normal ms-3"><i class="fas fa-yin-yangfas fa-circle px-1 text-success fs-10"></i> {{details.jobApplicationDetails?.displayStatus}} </span>
                                </div>
                                <span class="fs-7 text-muted mt-1 mb-5">created on {{details.registerDate | date:'dd MMM, yyyy'}}</span>

                                <div class="d-flex flex-wrap flex-stack">
                                    <div class="d-flex flex-column flex-grow-1 pe-8">
                                        <div class="d-flex flex-wrap lign-items-center text-gray-700">
                                            <div class=" me-10 my-1">
                                                <span class="d-flex text-muted fs-8">{{details.jobKind == 'Fixed' ? 'Budget' : 'Working Rate'}}</span>
                                                <span class="fw-bold d-flex">{{details.jobKind == 'Fixed' ? details.minBudget + ' ~ ' + details.maxBudget : details.rate}} {{details.currency}}</span>
                                            </div>
                                         
                                            <div class="vr me-5 mt-4 h-20px "></div>
                                            <div class=" me-10 my-1">
                                                <span class="d-flex text-muted fs-8">Business Unit</span>
                                                <span class="fw-bold d-flex">{{details.businessUnit}}</span>
                                            </div>
                                            <div class="vr me-5 mt-4 h-20px "></div>
                                            <div class=" me-10 my-1">
                                                <span class="d-flex text-muted fs-8">Site</span>
                                                <span class="fw-bold d-flex">{{details.site}}</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div>
                                <div> <div class="w-20px display-inline my-1 me-1"><img class="" src="../../../assets/images/icons/calendar.svg" alt=""> </div>  {{details.startDate | date:'MMM dd'}} - {{details.endDate | date:'dd MMM, yyyy'}} </div>
                                <div><div class="w-20px  display-inline my-1 me-1"><img class="" src="../../../assets/images/icons/coin.svg" alt=""></div> {{details.jobKind}}</div>
                                <div><div class="w-20px  display-inline my-1 me-1"><img class="" src="../../../assets/images/icons/case.svg" alt=""></div> {{details.type}}</div>
                                <div class=" mt-4  d-flex">
                                    <div class="symbol symbol-35px symbol-circle me-3">
                                            <img src="../../../assets/media/avatars/300-12.jpg" alt="">
                                    </div>

                                    <div>
                                        <span class="d-flex text-muted fs-8">Worker</span>
                                        <span class="fw-bold d-flex s-">{{details.jobApplicationDetails?.firstName}} {{details.jobApplicationDetails?.lastName}}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </ng-container>
        </ng-container>

        <ng-container *ngIf="selectedTab=='ConfirmedJob'">
            <ng-container *ngFor="let details of jobDetails | slice: currentPage * pageSize : (currentPage + 1) * pageSize">
                <div class="card mb-2">
                    <div class="card-body py-5">
                        <div class="d-flex justify-content-between align-items-start flex-wrap">
                            <div class="d-flex flex-column w-75">
                                <h6 class="text-dark  text-gray-800 fs-3  me-1">{{details.title}}</h6>
                                <div class="d-flex">
                                    <a class="fw-bold cursor-pointer display-inline" (click)="goToDetails(details.id)"> #{{details.id}}</a>
                                </div>
                                <span class="fs-7 text-muted mt-1 mb-5">created on {{details.registerDate | date:'dd MMM, yyyy'}}</span>

                                <div class="d-flex flex-wrap flex-stack">
                                    <div class="d-flex flex-column flex-grow-1 pe-8">
                                        <div class="d-flex flex-wrap lign-items-center text-gray-700">
                                            <div class=" me-10 my-1">
                                                <span class="d-flex text-muted fs-8">{{details.jobKind == 'Fixed' ? 'Budget' : 'Working Rate'}}</span>
                                                <span class="fw-bold d-flex">{{details.jobKind == 'Fixed' ? details.minBudget + ' ~ ' + details.maxBudget : details.rate}} {{details.currency}}</span>
                                            </div>
                                         
                                            <div class="vr me-5 mt-4 h-20px "></div>
                                            <div class=" me-10 my-1">
                                                <span class="d-flex text-muted fs-8">Business Unit</span>
                                                <span class="fw-bold d-flex">{{details.businessUnit}}</span>
                                            </div>
                                            <div class="vr me-5 mt-4 h-20px "></div>
                                            <div class=" me-10 my-1">
                                                <span class="d-flex text-muted fs-8">Site</span>
                                                <span class="fw-bold d-flex">{{details.site}}</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div>
                                <div> <div class="w-20px display-inline my-1 me-1"><img class="" src="../../../assets/images/icons/calendar.svg" alt=""> </div>  {{details.startDate | date:'MMM dd'}} - {{details.endDate | date:'dd MMM, yyyy'}} </div>
                                <div><div class="w-20px  display-inline my-1 me-1"><img class="" src="../../../assets/images/icons/coin.svg" alt=""></div> {{details.jobKind}}</div>
                                <div><div class="w-20px  display-inline my-1 me-1"><img class="" src="../../../assets/images/icons/case.svg" alt=""></div> {{details.type}}</div>
                                <div class=" mt-4  d-flex">
                                    <div class="symbol symbol-35px symbol-circle me-3">
                                            <img src="../../../assets/media/avatars/300-12.jpg" alt="">
                                    </div>
                                    <div>
                                        <span class="d-flex text-muted fs-8">Worker</span>
                                        <span class="fw-bold d-flex s-">{{details.jobApplicationDetails?.firstName}} {{details.jobApplicationDetails?.lastName}}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </ng-container>
        </ng-container>

        <div *ngIf="jobDetails.length == 0" class="text-center fw-bold fs-3 mt-2">
            No Records Found
        </div>

        <mat-paginator *ngIf="jobDetails.length > 0" [pageSize]="pageSize" [pageSizeOptions]="[5, 10, 20, 30]" [length]="jobDetails.length"
               (page)="onPageChange($event)">
        </mat-paginator>


    </div>


</div>